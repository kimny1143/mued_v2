# MUED Layered Architecture Proposal
*Draft version — 2025-10-29*
*For internal use by MUED Architect Team*

---

## 1. LMS層（現行MUED構成 ― 事業計画スコープ）

### 目的
MUEDを「教育SaaS」として成立させる基盤機能群を確立し、安定運用・収益化・補助金適格性を担保する。

### 現行範囲
- **主要機能:** レッスン予約、教材生成、学習履歴管理、Stripe課金、メンターマッチング。  
- **利用対象:** 一般ユーザー（B2C）および教育機関・法人顧客（B2B）。  
- **アーキテクチャ:** Flask + Next.js、Postgres + Drizzle ORM、Redisキャッシュ構成。  
- **AI活用:** GPT/Claude APIによる教材生成とフィードバック補助。  
- **KPI:** 月次経常収益100万円、3年で年間経常収益1億円を目標。  

この層はMUEDの信用基盤であり、教育現場や法人導入のための**説明可能な構造**を担う。

---

## 2. 創造データ層（理念拡張スコープ）

### 目的
人間とAIの創造過程をデータとして記録・分析し、「創造の学習基盤」として再定義する。  
LMSで得た学習データの上に、「反芻・誤差・再生成」を扱う**創造知のデータ層**を形成する。

### 構成要素

#### データ層
- `creation_trace` テーブル：AIと人間の生成ログを保存（プロンプト、レスポンス、修正履歴、誤差タグ）。  
- `ai_dialogue_log`：反芻的な対話履歴を格納し、後続AI提案の文脈参照に活用。  

#### AI層
- 教材生成と創造対話を分離（`/api/ai/materials` と `/api/ai/dialogue`）。  
- RAG（Retrieval-Augmented Generation）による過去対話参照。  
- 「創造過程に応じたAI提案」を動的生成。  

#### UX層
- **反芻ダッシュボード**：ユーザーの思考・生成履歴を視覚化。  
- **誤差マップ**：AI出力との差異を抽出し、再生成を促すインターフェース。  

この層は教育管理の上位に位置し、**創造と学習の境界をデータとして再構築する**。

---

## 3. アーキテクト実装指針（両層の接続アクション）

### 3.1 技術アクションプラン

| 層 | 改修対象 | 実装項目 | 成果物 |
|----|-----------|-----------|---------|
| データ | `db/schema.ts` | `creation_trace`, `ai_dialogue_log` テーブル追加 | schema更新PR |
| API | `/api/ai/trace`, `/api/ai/dialogue` | 生成ログの記録と参照 | β版API |
| フロント | `app/dashboard` | 反芻ダッシュボードUI | モック実装 |
| AI | `aiService.ts` | 教材生成APIと創造対話APIを分離 | サービス層更新 |

### 3.2 開発スプリント計画

| Sprint | 期間 | 主担当 | 目標 |
|--------|------|--------|------|
| 1 | 2週 | API/DB担当 | 生成ログ保存と取得API |
| 2 | 3週 | Frontend担当 | 反芻ダッシュボードUI |
| 3 | 3週 | AI担当 | 誤差抽出・再提案機能統合 |

### 3.3 検証KPI

- **技術KPI:** ログ保存成功率 > 99%、AIレスポンス遅延 < 500ms。  
- **体験KPI:** AI再生成利用率、反芻UI滞在時間、再提案採用率。  

---

## 4. 結語 ― 二層統合によるMUEDの進化軸

現行MUEDのLMS構成は、理念を地に足のついた形で具現化した“基層”である。  
しかし真価は、その上に「創造の記録・分析・再利用」を行う**創造データ層**を積み重ねることで発揮される。  

この二層構造（LMS層 × 創造データ層）は、  
「教育SaaSとしての説明可能性」と「創造研究プラットフォームとしての拡張性」を両立させる最適解である。

---

*Prepared by: MUED Architecture Research Group / glasswerks inc.*  
