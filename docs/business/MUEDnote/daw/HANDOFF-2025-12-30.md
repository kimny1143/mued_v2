# DAW連携開発 引き継ぎメモ

**日付**: 2025-12-30
**ステータス**: PoC完了、本番実装待ち

---

## 1. 完了した作業

### PoC検証（全完了）

| DAW/技術 | 結果 | ドキュメント |
|---------|------|-------------|
| Ableton OSC | ✅ 成功 | [poc-ableton-osc.md](./poc-ableton-osc.md) |
| Pro Tools PTSL | ⚠️ 制限あり | [poc-protools-ptsl.md](./poc-protools-ptsl.md) |
| MIDI IAC | ✅ 成功 | [poc-midi-iac.md](./poc-midi-iac.md) |
| Digital Performer | 📋 資料収集 | [digital-performer-osc-reference.md](./digital-performer-osc-reference.md) |

### 重要な発見

1. **Pro Tools SDK制限**: フェーダー/プラグインパラメータのAPIが未実装（Avid側の制限）
2. **Ableton最有力**: OSC経由でミキシング操作のフルログ取得可能
3. **MIDI共通化**: IAC Driver経由で全DAW共通の演奏ログ取得可能
4. **DP有望**: OSCで「nearly-complete bindings」とのこと、受託事業（カラオケMIDI）連携で価値あり

### ドキュメント整理

- 旧 `muednote-daw-poc-report.md` → DAW/技術別に分割
- [muednote-daw-poc-overview.md](./muednote-daw-poc-overview.md): 比較概要
- [muednote-daw-full-scope.md](./muednote-daw-full-scope.md): 計画・ロードマップ

---

## 2. 現在のコード状態

### MUEDnote Hub (Swift macOS)

```
apps/muednote-hub-macos/Sources/MUEDnoteHub/
├── MUEDnoteHubApp.swift           # メインアプリ（MIDI統合済み）
├── Services/
│   ├── OSCReceiverService.swift   # Ableton OSC連携（実装済み）
│   └── MIDIReceiverService.swift  # CoreMIDI受信（実装済み、未コミット）
└── Views/
    └── MenuBarView.swift          # UI（MIDI表示対応済み）
```

**注意**: `MIDIReceiverService.swift` は git status で untracked になっている

### Pro Tools テストスクリプト

```
scripts/protools-poc/
├── PTSL.proto              # Avid SDK からコピー
├── PTSL_pb2.py             # 生成されたProtobuf
├── PTSL_pb2_grpc.py        # 生成されたgRPC
└── ptsl_test.py            # テストクライアント
```

---

## 3. 次のステップ（優先順）

### 高優先度

| タスク | 工数目安 | 備考 |
|-------|---------|------|
| MIDIReceiverService.swift をコミット | 10分 | 未コミットファイルあり |
| API送信実装（OSC） | 1-2日 | MUED APIへPOST |
| API送信実装（MIDI） | 1-2日 | 同上 |
| 収録中スキップ実装 | 0.5日 | DAW録音中はMIDIログ不要 |

### 中優先度

| タスク | 工数目安 | 備考 |
|-------|---------|------|
| Digital Performer PoC | 3-5日 | OSC接続テスト |
| ログ量最適化 | 2-3日 | CCデバウンス調整等 |
| maxParamsPerDevice増加 | 0.5日 | 8 → 16〜32 |

### 低優先度

| タスク | 備考 |
|-------|------|
| Pro Tools対応 | SDK制限により実用性低い |
| Logic Pro対応 | Smart Controls 12ノブ/タブ上限 |
| Cubase対応 | Quick Controls 8パラメータ上限 |

---

## 4. 技術メモ

### Ableton OSC

- ポート: 送信 11000、受信 11001
- AbletonOSC（Max for Live）が必要
- リスナーは不安定 → ポーリング方式採用（200ms間隔）

### MIDI IAC

- Audio MIDI Setup.app で IAC Driver を有効化
- DAW側で IAC Driver への MIDI Output 設定
- フィードバック防止: DAWの IAC Input Track をオフに

### Pro Tools PTSL

- gRPC (TCP port 31416)
- SDK: `/Users/kimny/Dropbox/_DevProjects/AVID_SDK/PTSL_SDK_CPP.2025.10.0.1232349/`
- GetTrackControlInfo (ID: 148) は "Not yet implemented"

---

## 5. リリース戦略（推奨）

```
v1.0: Ableton OSC + MIDI（ミキシング＋演奏ログ）
v1.1: Digital Performer対応（受託事業連携）
v2.0: 他DAW検討
```

Pro Toolsはターゲット外（SDK制限＋ユーザー層の抵抗感）

---

## 6. 関連リソース

- [AbletonOSC](https://github.com/ideoforms/AbletonOSC)
- [OSCKit](https://github.com/orchetect/OSCKit)
- [MIDIKit](https://github.com/orchetect/MIDIKit)
- [PTSL SDK](file:///Users/kimny/Dropbox/_DevProjects/AVID_SDK/PTSL_SDK_CPP.2025.10.0.1232349/)

---

*作成: Claude Code*
